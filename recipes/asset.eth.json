{
  "symbol":"eth",
  "name":"Ethereum",
  "module":"ethereum",
  "mode":"ethereum.main",
  "fee":0.00025,
  "factor":18,
  "host":["https://mainnet.infura.io/mew","https://api.myetherwallet.com/eth"],
  "contract":"0x0000000000000000000000000000000000000000",
  "cache":15000,
  "timeout":30000,
  "throttle":1,
  "cron":300,
  "histPage":25,
  "quartz":{
    "validate" : [
      "rout '/source/wavalidator/$symbol/$1'",
      "done"
    ],
    "sample":[
      "done {address:'0x896a0b2b259d62fd27aeab05c81bb1897ecf767b',transaction:'0x5496d381d8b2c6ae028c69f90a643f1c453bbfd0381df9d0af0e20b09a04dadd'}"
    ],
    "_balance":[
      "rand 10000",
      "data {jsonrpc: '2.0', method: 'eth_getBalance', params: ['$1','latest'], id: $}",
      "curl asset://$symbol '' POST {'Content-Type': 'application/json'}"
    ],
    "fee-factor" : [
      "call 'fee-symbol'",
      "peek '${data}::factor'",
      "done"
    ],
    "contract" : [
      "done '$contract'"
    ],
    "factor" : [
      "done '$factor'"
    ],
    "mode" : [
      "done '$mode'"
    ],
    "fee-symbol" : [
      "data '$symbol'",
      "splt '.'",
      "pick 0",
      "done"
    ],
    "generated" : [
      "data '$generated'",
      "flow 'undefined' 1 2",
      "data 'never'",
      "done"
    ],
    "keygen-base" : [
      "data '$keygen-base'",
      "flow 'undefined' 1 2",
      "data '$symbol'",
      "splt '.'",
      "pick 0",
      "done"
    ],
    "unified-symbols" : [
      "data '$unified-symbols'",
      "flow 'undefined' 1 2",
      "data null",
      "done"
    ],
    "details" : [
      "data {'contract':null,'factor':null,'fee':null,'fee-factor':null,'fee-symbol':null,'mode':null,'keygen-base':null,'unified-symbols':null}",
      "each subdetails",
      "done {symbol:'$symbol',name:'$name',fee:'${.fee}',factor:'${.factor}',contract:'${.contract}',mode:'${.mode}','unified-symbols':'${.unified-symbols}','fee-symbol':'${.fee-symbol}','fee-factor':'${.fee-factor}','keygen-base':'${.keygen-base}', generated:'never'}"
    ],
    "subdetails" : [
      "call '${.key}'"
    ],
    "unspent" : [
      "@retryLoop",
      "rand 1000",
      "data {'jsonrpc': '2.0', 'method': 'eth_getTransactionCount', 'params': ['$1','pending'], 'id': $}",
      "curl asset://$symbol '' POST {'Content-Type': 'application/json'}",
      "tran '.result' 1 2",
      "code 'hex' 'dec'",
      "done {'nonce':'$'}",
      "logs 2 'module ethereum: bad RPC response, retrying request...'",
      "wait 1500",
      "loop @retryLoop 'retries' '<9' '1'",
      "fail 'Error: Ethereum network not responding. Cannot get nonce!'"
    ],
    "history" : [
      "data $symbol",
      "flow eth 2 1",
      "fail 'History not yet available for tokens'",
      "time $timeout",
      "rand 10000",
      "poke randomId",
      "with pageOffset [data,'$offset'] [math,'/$histPage .floor']",
      "with pages [data,'$count'] [math,'/$histPage .floor']",
      "poke page '$pageOffset'",
      "@countLoop",
      "curl http://api.etherscan.io/api ?module=account&action=txlist&address=$1&page=$page&offset=25&sort=desc&startblock=0&endblock=99999999&apikey=YourApiKeyToken GET {'Content-Type': 'application/json'}",
      "tran '.result' 2 1",
      "fail 'Ethereum node returning unexpected result!'",
      "poke 'tempResultArray'",
      "with 'resultArray' ['fuse',$tempResultArray]",
      "loop @countLoop 'page' '<=$pages'",
      "data $resultArray",
      "sort ['.timeStamp',num,desc]",
      "tran '[].hash' 2 1",
      "fail 'Cannot interpret history data!'",
      "with offset [math,'$offset - ($histPage*$pageOffset)']"
    ],
    "test" : [
      "done {hash:dynamic}"
    ],
    "push":[
      "rand 1000",
      "data {'jsonrpc': '2.0', 'method': 'eth_sendRawTransaction', 'params': ['$1'], 'id': $}",
      "curl asset://$symbol '' POST {'Content-Type': 'application/json'}",
      "tran('.result',1,3)",
      "regx('^0x',1,2)",
      "done",
      "tran('.error',1,2)",
      "fail",
      "logs(2,'module ethereum: bad RPC response, retrying request...')",
      "wait 1500",
      "loop @retryLoop 'retries' '<9' '1'",
      "fail 'Error: Ethereum network not responding. Cannot push transaction!'"
    ],
    "transactionData" : [
      "data '$1_$symbol'",
      "hash",
      "poke storageHash",
      "load 'tx$storageHash' 1 @requestData",
      "unpk 1 @requestData",
      "logs 'getting transaction data from storage $1'",
      "done",
      "@requestData",
      "time $timeout",
      "rand 10000",
      "poke 'randomId'",
      "data {jsonrpc: '2.0', method: 'eth_getTransactionByHash', params: ['$1'], id: $randomId}",
      "curl asset://$symbol '' POST {'Content-Type': 'application/json'}",
      "tran .result 3 1",
      "logs",
      "fail 'Cannot read transaction data!'",
      "poke txData",
      "pack",
      "save 'tx$storageHash'",
      "peek txData",
      "done"
    ],
    "transaction" : [
      "time $timeout",
      "call 'transactionData/$1'",
      "with .value [code,'hex','dec'] [atom]",
      "with txGas [data,'${.gas}'] [code,'hex','dec']",
      "with txGasPrice [data,'${.gasPrice}'] [code,'hex','dec']",
      "with txFee [math,'$txGas*$txGasPrice'] [atom]",
      "with txHeight [data,'${.blockNumber}'] [code,'hex','dec']",
      "with fee-symbol [call,'fee-symbol']",
      "with timestamp [call,'blockRaw/${.blockNumber}'] [tran,'.result.timestamp',2,1] [data,0] [code,'hex','dec'] [done]",
      "tran { id:'.hash', timestamp:'$timestamp', height:'$txHeight', amount:'.value', symbol:'$symbol', fee:'$txFee', 'fee-symbol':'$fee-symbol', source:'.from', target:'.to', confirmed:true } @okayData @failData",
      "@failData",
      "fail 'Cannot interpret transaction data!'",
      "@okayData"
    ],
    "attachment" : [
      "time $timeout",
      "call 'transactionData/$1'",
      "tran '.input' 2 1",
      "done null",
      "done"
    ],
    "message" : [
      "time $timeout",
      "call 'attachment/$1'",
      "code hex utf8",
      "done"
    ],
    "status" : [
      "call history/$1/3/0",
      "join",
      "hash sha256"
    ],
    "blockRaw" : [
      "rand 10000",
      "poke 'randomId'",
      "data {jsonrpc: '2.0', method: 'eth_getBlockByNumber', params: ['$1',false], id: $randomId}",
      "curl asset://$symbol '' POST {'Content-Type': 'application/json'}",
      "done"
    ],
    "cron" : [
      "time(45000)",
      "data $symbol",
      "flow eth 2 1",
      "done",
      "logs 'module ethereum: updating fee'",
      "rand 10000",
      "data {jsonrpc: '2.0', method: 'eth_gasPrice', params: [], id: $}",
      "curl asset://$symbol '' POST {'Content-Type': 'application/json'}",
      "func updateFee",
      "done"
    ],
    "balance" : [
      "time(45000)",
      "@retryLoop",
      "data $symbol",
      "find '.' @token 1",
      "rand 10000",
      "data {jsonrpc: '2.0', method: 'eth_getBalance', params: ['$1','latest'], id: $}",
      "curl asset://$symbol '' POST {'Content-Type': 'application/json'}",
      "jump @transform",
      "@token",
      "data '$'",
      "func encode",
      "poke encoded",
      "rand 10000",
      "data {jsonrpc: '2.0', method: 'eth_call', params: [{to:'$contract',data:'$encoded'},pending], id: $}",
      "curl asset://$symbol '' POST {'Content-Type': 'application/json'}",
      "@transform",
      "poke transaction",
      "data $symbol",
      "find 'ubq' @ubq @other",
      "@ubq",
      "peek transaction",
      "tran('.result',1,@failure1)",
      "regx('^\\d',1,@failure1)",
      "atom",
      "form",
      "done",
      "@failure1",
      "fail' Error: Ethereum network not responding. Cannot get balance!'",
      "@other",
      "peek transaction",
      "tran(.result,1,@failure)",
      "regx('^0x',1,@failure)",
      "code 'hex' 'dec'",
      "atom",
      "form",
      "done",
      "@failure",
      "logs(2,'module ethereum: bad RPC response, retrying request...')",
      "wait(1500)",
      "loop(@retryLoop,retries,'<9','1')",
      "fail('Error: Ethereum network not responding. Cannot get balance!')"
    ],
    "fee":[
      "time(45000)",
      "func getFee"
      ]
  }
}
