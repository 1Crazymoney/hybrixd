{
  "engine":"valuations",
  "name":"Querries the valuation of 1 currency in another.",
  "module":"valuations",
  "sources" : {
    "EUCentralBank" : {
      "notes": "European central bank for fiat-exchange rates: https://www.ecb.europa.eu/stats/eurofxref/eurofxref-daily.xml",
      "type":"none",
      "site": "http://www.ecb.europa.eu/stats/eurofxref/eurofxref-daily.xml"
    },
    "coinmarketcap": {
      "notes" :"coinmarketcap: https://coinmarketcap.com/api/",
      "type":"json",
      "site": "https://api.coinmarketcap.com/v2/ticker/"
    },
    "coinbase" : {
      "notes":"coinbase: https://developers.coinbase.com/api/v2#exchange-rates",
      "type":"json",
      "site": "https://api.coinbase.com/v2/exchange-rates"
    },
    "binance": {
      "notes":"https://github.com/binance-exchange/binance-official-api-docs/blob/master/rest-api.md",
      "type":"json",
      "site": "https://api.binance.com/api/v1/ticker/price"
    },
    "hitbtc_symbols":{
      "notes":"hitbtc: https://api.hitbtc.com/",
      "type":"json",
      "site": "https://api.hitbtc.com/api/2/public/symbol"
    },
    "hitbtc_prices": {
      "notes":"hitbtc: https://api.hitbtc.com/",
      "type":"json",
      "site": "https://api.hitbtc.com/api/2/public/ticker"
    }
  },
  "quartz" : {
    "cron":[
      "each $sources 'download'",
      "func 'parse'",
      "poke 'local::prices'",
      "done 'Finished'"
    ],
    "download":[
      "poke 'key' ($.key)",
      "poke 'site' ($.value.site)",
      "poke 'type' ($.value.type)",
      "curl '$site' '' 'GET' {} {parsing:'$type'}",
      "done"
    ],
    "rate":[
      "data {source: '$1', target:'$2', amount:'$3', prices: $local::prices}",
      "func 'valuate'",
      "done"
    ]
  },
  "router" : {
    "cron" : "Download new price data",
    "rate": {
      "_ref" : {
        "_list" : "Source_Symbol",
        "_ref" : {
          "_list" : "Target_Symbol",
          "_this" : "Retrieve the median exchange-rate for one coin in another coin.",
          "_ref" : {
            "_list" : "Amount",
            "_this" : "Retrieve the median exchange-rate for a given amount of one coin in another coin."
          }
        }
      }
    }
  }
}
